---
title: 需求和架构设计
  group:
    path: /framework/week1
    title: 需求和架构设计
---

## 关键词

- 分析需求的工具-流程工具
- 全局思维、整体思维、闭环思维 - 架构师思维来分析需求
- 业务组件库 - 独立拆分出来，复用
- 自定义事件统计 - 业务的重要性，如何实现

### 如何以架构师思维来分析需求

1. 全局思维
2. 整体思维
3. 闭环思维

架构师要做到业务增长。

### 项目的浅层需求

需求指导设计，设计指导开发

### 深度需求的分析

#### 作品管理

1. 删除和恢复
2. 转增（例如：员工离职交接工作）
3. 复制

#### 作品统计（闭环）

1. 统计
2. 分渠道统计

#### 作品发布

1. url 不能变
2. 支持多渠道

### 架构设计

架构师的职责，就是在深入理解业务需求之后，能用软件把业务模拟出来。技术永远都是为业务服务的。

#### 分析需求，确定要创建的项目

先不看细节，看整体，这一步就是确定项目的范围。确定范围是做任何事情的第一步。

从需求来看：B 端和编辑器，H5，管理后台

- B 端和编辑器，做前后端分离

- H5 适合做 SSR，因为要考虑到性能

使用 SSR 需要分场景，一般来讲 toB 的不适合用，toC 的比较适合用。所以架构需要考虑成本，要用最简单的方案，不要为了设计而设计

- 管理后台，做前端分析

### 为何要自研统计服务

- 支持定义事件统计
- 支持 OpenAPI（重要）

自研一个自研统计服务：

1. 日志收集
2. 日志分析
3. OpenAPI

### 数据结构设计

- node 结构要符合 VNode 结构
- 组件对象，而是用数组，数组是可以排序的
- 都知道存储到 vuex 中即可同步数据，但问题是如何用 vuex 表示当前选中的组件
- 图层，应该是 computed 计算出来的索引，而不是一个单独的数据

正确的设计思路：

```js

const store  = {
  work:{
    title:"作品标题",
    setting:{
    //  预留配置项
    },
    props:{
      // 画布的设计
    },
    components:[
      {
        id:"xxx",
        name:"文本1",
        tag:"text",
        attrs:{fontSize:'20px'},
        children:[
          // 文本内容，有时候放在children
        ]
      }
    ]
  },
  activeComponentId:"xxx" // 当前选中的组件
}

const getters = {
  layers () => {
    return store.work.components.map(v=>{
      return{
        id:v.id,
        name:v.name
      }
    })
  }
}

```

#### 数据流转

1. 创建作品：初始化一个 JSON 数据
2. 保存作品：修改一个 JSON 数据
3. 发布作品：修改一个标记
4. C 端浏览作品：获取 JSON 数据，SSR 进行渲染
5. 作品下线：修改一个标记

- 需要做一下缓存配置，防止频繁的访问数据库

### 注意点

现在的阶段主要是设计的一些方向，不需要抠细节，需要进行论证可行性、扩展性、复杂度高低。
我们没法现在确定细节，更没法保证未来的细节，就一定和现在一模一样。

### 写技术方案设计文档

- 为何难写？

1. 没有规范可依
2. 不常写

- 如何写，技巧：

1. 随性一些，解释一下你要如何做，即可
2. 可以先尝试写一部分代码，捋捋思路，再来写文档 【注意】这里写代码纯是为了捋思路，为了写文档，搞清楚目的

- 写设计文档是浪费时间吗？

1. 如果你真的想明白了，最多浪费 1-2h 时间，不会导致项目延期
2. 如果你写不出来，说明你没想明白，正好暴露了问题

## 学习方法

1. 要有耐心，不能光想着写代码，觉得需求和设计不重要
2. 抛开固有的程序员思维，开始准备接收架构师思维
3. 坚信：技术永远都是为业务服务的，技术是实现业务增长的工具

## 注意事项

- 不要关注细节，要看整体，看范围
- 设计时判断可行性，不确定的就调研一下（这需要大量的工作经验的积累，技术能力）
- 设计要考虑复杂度，越简单越好，不要过度设计，不要为了设计而设计

## 总结

浅层学习看输入，深入学习看输出
